import{u as se,_ as u,I as fe,cs as xe,n as ae,bM as ge,ct as Z,c as pe,cu as ie,cv as ve,cw as me,cx as he,t as we,r as $,cy as ye,R as ce,b0 as B,a8 as j,G as X,K as U,H as G,c9 as be,c7 as Ce,aI as Se,c8 as _e,cz as Ie,p as ee,cA as Me,N as ue,a$ as Ae,J as ke,b4 as ze,cB as Ee,cC as De,cD as T,cE as Ne,cF as Le,aV as $e,cG as je,cH as Re,Z as Te,ay as qe,aQ as Pe,a1 as te}from"../index-961d4ed1.js";import{S as Xe}from"./scrollable-list-74021d3b.js";import{S as ne}from"./status-container-8c0c48ff.js";import{P as Ge}from"./pending-status-d95ac051.js";const He=ae({load_more:{id:"status.load_more",defaultMessage:"Load more"}}),Oe=f=>{let{disabled:l,maxId:c,onClick:i}=f;const d=se();return u("button",{className:"load-more load-gap",disabled:l,onClick:()=>i(c),"aria-label":d.formatMessage(He.load_more)},void 0,u(fe,{src:xe}))},Ue="/packs/assets/timeline-72a32d57.svg",re={soapbox:async()=>(await Z(()=>import("./soapbox-config-24ffa57c.js"),["packs/js/soapbox-config-24ffa57c.js","packs/index-961d4ed1.js","packs/assets/index-32eac806.css"])).default,truth:async()=>(await Z(()=>import("./truth-3fff57f9.js"),["packs/js/truth-3fff57f9.js","packs/index-961d4ed1.js","packs/assets/index-32eac806.css"])).default},Ve=async f=>{const l=f(),c=ge(l),i=c.extensions.getIn(["ads","enabled"],!1)===!0,d=c.extensions.getIn(["ads","provider"],"soapbox");if(i&&re[d])return re[d]()},Be=5*60*1e3,Fe=(f,l=Be)=>f.expires_at?new Date().getTime()>new Date(f.expires_at).getTime()-l:!1,le={ads:["ads"]};function Ke(){const f=pe(),l=async()=>f(async(d,p)=>{const v=await Ve(p);return v?v.getAds(p):[]}),c=ie(le.ads,l,{placeholderData:[]}),i=ve(me).parse(c.data).filter(d=>!Fe(d));return{...c,data:i}}const Qe=f=>{let{ad:l}=f;const c=he(),i=we(),d=$.useRef(void 0),p=$.useRef(null),[v,s]=$.useState(!1);ie(["ads","impression",l.impression],async()=>{if(l.impression)return await ye.get(l.impression)},{cacheTime:1/0,staleTime:1/0});const e=()=>{c.invalidateQueries(le.ads)},n=()=>{s(!v)},o=t=>{t.target&&p.current&&!p.current.contains(t.target)&&s(!1)};return $.useEffect(()=>(document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}),[p]),$.useEffect(()=>{if(l.expires_at){const t=new Date(l.expires_at).getTime()-new Date().getTime();d.current=setTimeout(e,t)}return()=>{d.current&&clearTimeout(d.current)}},[l.expires_at]),u("div",{className:"relative"},void 0,u(B,{className:"py-4",variant:"rounded"},void 0,u(j,{space:4},void 0,u(G,{alignItems:"center",space:3},void 0,u(be,{src:i.thumbnail,size:42}),u(j,{grow:!0},void 0,u(G,{space:1},void 0,u(X,{size:"sm",weight:"semibold",truncate:!0},void 0,i.title),u(Ce,{className:"h-4 w-4 stroke-accent-500",src:Ue})),u(j,{},void 0,u(G,{alignItems:"center",space:1},void 0,u(X,{theme:"muted",size:"sm",truncate:!0},void 0,u(U,{id:"sponsored.subtitle",defaultMessage:"Sponsored post"}))))),u(j,{justifyContent:"center"},void 0,u(Se,{iconClassName:"h-6 w-6 stroke-gray-600",src:_e,onClick:n}))),u(Ie,{card:l.card,onOpenMedia:()=>{},horizontal:!0}))),v&&ce.createElement("div",{ref:p,className:"absolute right-5 top-5 max-w-[234px]"},u(B,{variant:"rounded"},void 0,u(j,{space:2},void 0,u(X,{size:"sm",weight:"bold"},void 0,u(U,{id:"sponsored.info.title",defaultMessage:"Why am I seeing this ad?"})),u(X,{size:"sm",theme:"muted"},void 0,l.reason?l.reason:u(U,{id:"sponsored.info.message",defaultMessage:"{siteTitle} displays ads to help fund our service.",values:{siteTitle:i.title}}))))))},oe=ae({heading:{id:"feed_suggestions.heading",defaultMessage:"Suggested Profiles"},viewAll:{id:"feed_suggestions.view_all",defaultMessage:"View all"}}),We=f=>{let{accountId:l}=f;const{account:c}=ze(l);return c?u(j,{space:3,className:"w-52 shrink-0 rounded-md border border-solid border-gray-300 p-4 dark:border-gray-800 md:w-full md:shrink md:border-transparent md:p-0 dark:md:border-transparent"},void 0,u(ue,{to:`/@${c.acct}`,title:c.acct},void 0,u(j,{space:3,className:"mx-auto w-40 md:w-24"},void 0,u("img",{src:c.avatar,className:"mx-auto block h-16 w-16 min-w-[56px] rounded-full object-cover",alt:c.acct}),u(j,{},void 0,u(G,{alignItems:"center",justifyContent:"center",space:1},void 0,u(X,{weight:"semibold",dangerouslySetInnerHTML:{__html:c.display_name_html},truncate:!0,align:"center",size:"sm",className:"max-w-[95%]"}),c.verified&&u(Ee,{})),u(X,{theme:"muted",align:"center",size:"sm",truncate:!0},void 0,"@",c.acct)))),u("div",{className:"text-center"},void 0,u(De,{account:c}))):null},Je=f=>{let{statusId:l,onMoveUp:c,onMoveDown:i}=f;const d=se(),p=ee(o=>o.suggestions.items);return!ee(o=>o.suggestions.isLoading)&&p.size===0?null:u(ke,{handlers:{moveUp:o=>{c&&c(l)},moveDown:o=>{i&&i(l)}}},void 0,u(B,{size:"lg",variant:"rounded",className:"focusable space-y-6",tabIndex:0},void 0,u(G,{justifyContent:"between",alignItems:"center"},void 0,u(Me,{title:d.formatMessage(oe.heading)}),u(ue,{to:"/suggestions",className:"text-primary-600 hover:underline dark:text-accent-blue"},void 0,d.formatMessage(oe.viewAll))),u(Ae,{},void 0,u(G,{space:4,alignItems:"center",className:"overflow-x-auto md:space-x-0 lg:overflow-x-hidden"},void 0,p.slice(0,4).map(o=>u(We,{accountId:o.account},o.account))))))};var F={exports:{}};F.exports;(function(f){(function(l,c,i){function d(e){var n=this,o=s();n.next=function(){var t=2091639*n.s0+n.c*23283064365386963e-26;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=t|0)},n.c=1,n.s0=o(" "),n.s1=o(" "),n.s2=o(" "),n.s0-=o(e),n.s0<0&&(n.s0+=1),n.s1-=o(e),n.s1<0&&(n.s1+=1),n.s2-=o(e),n.s2<0&&(n.s2+=1),o=null}function p(e,n){return n.c=e.c,n.s0=e.s0,n.s1=e.s1,n.s2=e.s2,n}function v(e,n){var o=new d(e),t=n&&n.state,r=o.next;return r.int32=function(){return o.next()*4294967296|0},r.double=function(){return r()+(r()*2097152|0)*11102230246251565e-32},r.quick=r,t&&(typeof t=="object"&&p(t,o),r.state=function(){return p(o,{})}),r}function s(){var e=4022871197,n=function(o){o=String(o);for(var t=0;t<o.length;t++){e+=o.charCodeAt(t);var r=.02519603282416938*e;e=r>>>0,r-=e,r*=e,e=r>>>0,r-=e,e+=r*4294967296}return(e>>>0)*23283064365386963e-26};return n}c&&c.exports?c.exports=v:i&&i.amd?i(function(){return v}):this.alea=v})(T,f,!1)})(F);var Ye=F.exports,K={exports:{}};K.exports;(function(f){(function(l,c,i){function d(s){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},s===(s|0)?e.x=s:n+=s;for(var o=0;o<n.length+64;o++)e.x^=n.charCodeAt(o)|0,e.next()}function p(s,e){return e.x=s.x,e.y=s.y,e.z=s.z,e.w=s.w,e}function v(s,e){var n=new d(s),o=e&&e.state,t=function(){return(n.next()>>>0)/4294967296};return t.double=function(){do var r=n.next()>>>11,a=(n.next()>>>0)/4294967296,g=(r+a)/(1<<21);while(g===0);return g},t.int32=n.next,t.quick=t,o&&(typeof o=="object"&&p(o,n),t.state=function(){return p(n,{})}),t}c&&c.exports?c.exports=v:i&&i.amd?i(function(){return v}):this.xor128=v})(T,f,!1)})(K);var Ze=K.exports,Q={exports:{}};Q.exports;(function(f){(function(l,c,i){function d(s){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^(t^t<<1))|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,s===(s|0)?e.x=s:n+=s;for(var o=0;o<n.length+64;o++)e.x^=n.charCodeAt(o)|0,o==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function p(s,e){return e.x=s.x,e.y=s.y,e.z=s.z,e.w=s.w,e.v=s.v,e.d=s.d,e}function v(s,e){var n=new d(s),o=e&&e.state,t=function(){return(n.next()>>>0)/4294967296};return t.double=function(){do var r=n.next()>>>11,a=(n.next()>>>0)/4294967296,g=(r+a)/(1<<21);while(g===0);return g},t.int32=n.next,t.quick=t,o&&(typeof o=="object"&&p(o,n),t.state=function(){return p(n,{})}),t}c&&c.exports?c.exports=v:i&&i.amd?i(function(){return v}):this.xorwow=v})(T,f,!1)})(Q);var et=Q.exports,W={exports:{}};W.exports;(function(f){(function(l,c,i){function d(s){var e=this;e.next=function(){var o=e.x,t=e.i,r,a;return r=o[t],r^=r>>>7,a=r^r<<24,r=o[t+1&7],a^=r^r>>>10,r=o[t+3&7],a^=r^r>>>3,r=o[t+4&7],a^=r^r<<7,r=o[t+7&7],r=r^r<<13,a^=r^r<<9,o[t]=a,e.i=t+1&7,a};function n(o,t){var r,a=[];if(t===(t|0))a[0]=t;else for(t=""+t,r=0;r<t.length;++r)a[r&7]=a[r&7]<<15^t.charCodeAt(r)+a[r+1&7]<<13;for(;a.length<8;)a.push(0);for(r=0;r<8&&a[r]===0;++r);for(r==8?a[7]=-1:a[r],o.x=a,o.i=0,r=256;r>0;--r)o.next()}n(e,s)}function p(s,e){return e.x=s.x.slice(),e.i=s.i,e}function v(s,e){s==null&&(s=+new Date);var n=new d(s),o=e&&e.state,t=function(){return(n.next()>>>0)/4294967296};return t.double=function(){do var r=n.next()>>>11,a=(n.next()>>>0)/4294967296,g=(r+a)/(1<<21);while(g===0);return g},t.int32=n.next,t.quick=t,o&&(o.x&&p(o,n),t.state=function(){return p(n,{})}),t}c&&c.exports?c.exports=v:i&&i.amd?i(function(){return v}):this.xorshift7=v})(T,f,!1)})(W);var tt=W.exports,J={exports:{}};J.exports;(function(f){(function(l,c,i){function d(s){var e=this;e.next=function(){var o=e.w,t=e.X,r=e.i,a,g;return e.w=o=o+1640531527|0,g=t[r+34&127],a=t[r=r+1&127],g^=g<<13,a^=a<<17,g^=g>>>15,a^=a>>>12,g=t[r]=g^a,e.i=r,g+(o^o>>>16)|0};function n(o,t){var r,a,g,_,E,k=[],R=128;for(t===(t|0)?(a=t,t=null):(t=t+"\0",a=0,R=Math.max(R,t.length)),g=0,_=-32;_<R;++_)t&&(a^=t.charCodeAt((_+32)%t.length)),_===0&&(E=a),a^=a<<10,a^=a>>>15,a^=a<<4,a^=a>>>13,_>=0&&(E=E+1640531527|0,r=k[_&127]^=a+E,g=r==0?g+1:0);for(g>=128&&(k[(t&&t.length||0)&127]=-1),g=127,_=4*128;_>0;--_)a=k[g+34&127],r=k[g=g+1&127],a^=a<<13,r^=r<<17,a^=a>>>15,r^=r>>>12,k[g]=a^r;o.w=E,o.X=k,o.i=g}n(e,s)}function p(s,e){return e.i=s.i,e.w=s.w,e.X=s.X.slice(),e}function v(s,e){s==null&&(s=+new Date);var n=new d(s),o=e&&e.state,t=function(){return(n.next()>>>0)/4294967296};return t.double=function(){do var r=n.next()>>>11,a=(n.next()>>>0)/4294967296,g=(r+a)/(1<<21);while(g===0);return g},t.int32=n.next,t.quick=t,o&&(o.X&&p(o,n),t.state=function(){return p(n,{})}),t}c&&c.exports?c.exports=v:i&&i.amd?i(function(){return v}):this.xor4096=v})(T,f,!1)})(J);var nt=J.exports,Y={exports:{}};Y.exports;(function(f){(function(l,c,i){function d(s){var e=this,n="";e.next=function(){var t=e.b,r=e.c,a=e.d,g=e.a;return t=t<<25^t>>>7^r,r=r-a|0,a=a<<24^a>>>8^g,g=g-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-a|0,e.d=a<<16^r>>>16^g,e.a=g-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,s===Math.floor(s)?(e.a=s/4294967296|0,e.b=s|0):n+=s;for(var o=0;o<n.length+20;o++)e.b^=n.charCodeAt(o)|0,e.next()}function p(s,e){return e.a=s.a,e.b=s.b,e.c=s.c,e.d=s.d,e}function v(s,e){var n=new d(s),o=e&&e.state,t=function(){return(n.next()>>>0)/4294967296};return t.double=function(){do var r=n.next()>>>11,a=(n.next()>>>0)/4294967296,g=(r+a)/(1<<21);while(g===0);return g},t.int32=n.next,t.quick=t,o&&(typeof o=="object"&&p(o,n),t.state=function(){return p(n,{})}),t}c&&c.exports?c.exports=v:i&&i.amd?i(function(){return v}):this.tychei=v})(T,f,!1)})(Y);var rt=Y.exports,de={exports:{}};(function(f){(function(l,c,i){var d=256,p=6,v=52,s="random",e=i.pow(d,p),n=i.pow(2,v),o=n*2,t=d-1,r;function a(m,h,S){var y=[];h=h==!0?{entropy:!0}:h||{};var b=k(E(h.entropy?[m,L(c)]:m??R(),3),y),I=new g(y),A=function(){for(var M=I.g(p),D=e,z=0;M<n;)M=(M+z)*d,D*=d,z=I.g(1);for(;M>=o;)M/=2,D/=2,z>>>=1;return(M+z)/D};return A.int32=function(){return I.g(4)|0},A.quick=function(){return I.g(4)/4294967296},A.double=A,k(L(I.S),c),(h.pass||S||function(M,D,z,N){return N&&(N.S&&_(N,I),M.state=function(){return _(I,{})}),z?(i[s]=M,D):M})(A,b,"global"in h?h.global:this==i,h.state)}function g(m){var h,S=m.length,y=this,b=0,I=y.i=y.j=0,A=y.S=[];for(S||(m=[S++]);b<d;)A[b]=b++;for(b=0;b<d;b++)A[b]=A[I=t&I+m[b%S]+(h=A[b])],A[I]=h;(y.g=function(M){for(var D,z=0,N=y.i,P=y.j,x=y.S;M--;)D=x[N=t&N+1],z=z*d+x[t&(x[N]=x[P=t&P+D])+(x[P]=D)];return y.i=N,y.j=P,z})(d)}function _(m,h){return h.i=m.i,h.j=m.j,h.S=m.S.slice(),h}function E(m,h){var S=[],y=typeof m,b;if(h&&y=="object")for(b in m)try{S.push(E(m[b],h-1))}catch{}return S.length?S:y=="string"?m:m+"\0"}function k(m,h){for(var S=m+"",y,b=0;b<S.length;)h[t&b]=t&(y^=h[t&b]*19)+S.charCodeAt(b++);return L(h)}function R(){try{var m;return r&&(m=r.randomBytes)?m=m(d):(m=new Uint8Array(d),(l.crypto||l.msCrypto).getRandomValues(m)),L(m)}catch{var h=l.navigator,S=h&&h.plugins;return[+new Date,l,S,l.screen,L(c)]}}function L(m){return String.fromCharCode.apply(0,m)}if(k(i.random(),c),f.exports){f.exports=a;try{r=Ne}catch{}}else i["seed"+s]=a})(typeof self<"u"?self:T,[],Math)})(de);var ot=de.exports,st=Ye,at=Ze,it=et,ct=tt,ut=nt,lt=rt,q=ot;q.alea=st;q.xor128=at;q.xorwow=it;q.xorshift7=ct;q.xor4096=ut;q.tychei=lt;var dt=q;const ft=Le(dt),xt=(f,l,c)=>{const i=gt(c),d=Math.floor(l/i.pageSize),p=l%i.pageSize,v=ft(`${i.seed}-page-${d}`),s=Math.floor(v()*(i.range[1]-i.range[0]))+i.range[0];if(p===s)return f[d%f.length]},gt=f=>{const{seed:l,range:c,pageSize:i}=f&&typeof f=="object"?f:{};return{seed:typeof l=="string"?l:"",range:Array.isArray(c)?[Number(c[0]),Number(c[1])]:[2,6],pageSize:typeof i=="number"?i:20}},pt=(f,l,c)=>{const i=vt(c),d=f?Math.floor(l/i.interval)%f.length:0,p=f?f[d]:void 0;return(l+1)%i.interval===0?p:void 0},vt=f=>{const{interval:l}=f&&typeof f=="object"?f:{};return{interval:typeof l=="number"?l:20}},V={linear:pt,abovefold:xt},bt=f=>{let{statusIds:l,lastStatusId:c,featuredStatusIds:i,divideType:d="border",onLoadMore:p,timelineId:v,isLoading:s,isPartial:e,showAds:n=!1,showGroup:o=!0,...t}=f;const{data:r}=Ke(),a=$e(),g=String(a.extensions.getIn(["ads","algorithm",0])),_=a.extensions.getIn(["ads","algorithm",1],je()).toJS(),E=$.useRef(null),k=$.useRef(Re()),R=()=>(i==null?void 0:i.size)||0,L=(x,w)=>w?(i==null?void 0:i.keySeq().findIndex(C=>C===x))||0:l.keySeq().findIndex(C=>C===x)+R(),m=function(x){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=L(x,w)-1;y(C)},h=function(x){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=L(x,w)+1;y(C)},S=$.useCallback(Te(()=>{const x=c||l.last();p&&x&&p(x.replace("末suggestions-",""))},300,{leading:!0}),[p,c,l.last()]),y=x=>{var w;(w=E.current)==null||w.scrollIntoView({index:x,behavior:"smooth",done:()=>{const C=document.querySelector(`#status-list [data-index="${x}"] .focusable`);C==null||C.focus()}})},b=x=>{const w=l.toList(),C=w.get(x+1),H=w.get(x-1);return x<1||!C||!H||!p?null:u(Oe,{disabled:s,maxId:H,onClick:p},"gap:"+C)},I=x=>u(ne,{id:x,onMoveUp:m,onMoveDown:h,contextType:v,showGroup:o,variant:d==="border"?"slim":"rounded"},x),A=(x,w)=>u(Qe,{ad:x},`ad-${w}`),M=x=>{const w=x.replace(/^末pending-/,"");return u(Ge,{idempotencyKey:w},x)},D=()=>i?i.toArray().map(x=>u(ne,{id:x,featured:!0,onMoveUp:m,onMoveDown:h,contextType:v,showGroup:o,variant:d==="border"?"slim":"default"},`f-${x}`)):[],z=x=>u(Je,{statusId:x,onMoveUp:m,onMoveDown:h},"suggestions"),N=()=>s||l.size>0?l.toList().reduce((x,w,C)=>{var H;if(n&&r){const O=(H=V[g])==null?void 0:H.call(V,r,C,{..._,seed:k.current});O&&x.push(A(O,C))}if(w===null){const O=b(C);O&&x.push(O)}else w.startsWith("末suggestions-")?a.feedInjection&&x.push(z(w)):w.startsWith("末pending-")?x.push(M(w)):x.push(I(w));return x},[]):[],P=()=>{const x=D(),w=N();return x&&w?x.concat(w):w};return e?u("div",{className:"regeneration-indicator"},void 0,u("div",{},void 0,u("div",{className:"regeneration-indicator__label"},void 0,u(U,{id:"regeneration_indicator.label",tagName:"strong",defaultMessage:"Loading…"}),u(U,{id:"regeneration_indicator.sublabel",defaultMessage:"Your home feed is being prepared!"})))):ce.createElement(Xe,qe({id:"status-list",key:"scrollable-list",isLoading:s,showLoading:s&&l.size===0,onLoadMore:S,placeholderComponent:()=>u(Pe,{variant:d==="border"?"slim":"rounded"}),placeholderCount:20,ref:E,className:te("divide-y divide-solid divide-gray-200 dark:divide-gray-800",{"divide-none":d!=="border"}),itemClassName:te({"pb-3":d!=="border"})},t),P())};export{bt as S};
