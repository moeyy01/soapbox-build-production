import{dQ as I,dR as w,dS as E,dT as k,u as P,c as A,r as h,dU as T,p as G,cG as H,_ as e,ak as J,al as c,K as f,am as m,bv as L,n as q,bq as B}from"../index-961d4ed1.js";const K=(d,t,a)=>d.map((s,i)=>a.get(i)?k(s).add(t):k(s).delete(t)),N=(d,t)=>(a,s)=>a(I()).then(()=>{const i=s().admin.get("configs"),g=w.toSimplePolicy(i),u=K(g,d,t),o=w.fromSimplePolicy(u);return a(E(o.toJS()))}),S=q({mediaRemoval:{id:"edit_federation.media_removal",defaultMessage:"Strip media"},forceNsfw:{id:"edit_federation.force_nsfw",defaultMessage:"Force attachments to be marked sensitive"},unlisted:{id:"edit_federation.unlisted",defaultMessage:"Force posts unlisted"},followersOnly:{id:"edit_federation.followers_only",defaultMessage:"Hide posts except to followers"},save:{id:"edit_federation.save",defaultMessage:"Save"},success:{id:"edit_federation.success",defaultMessage:"{host} federation was updated"}}),Q=d=>{let{host:t,onClose:a}=d;const s=P(),i=A(),g=h.useCallback(T(),[]),u=G(l=>g(l,t)),[o,v]=h.useState(H());h.useEffect(()=>{v(u.get("federation"))},[u]);const _=l=>r=>{let{target:p}=r;v(o.set(l,p.checked))},C=l=>{let{target:{checked:r}}=l;const p=o.merge({avatar_removal:r,banner_removal:r,media_removal:r});v(p)},R=()=>{i(N(t,o)).then(()=>B.success(s.formatMessage(S.success,{host:t}))).catch(()=>{}),a()},{avatar_removal:y,banner_removal:F,federated_timeline_removal:j,followers_only:M,media_nsfw:x,media_removal:b,reject:n}=o.toJS(),D=y&&F&&b;return e(L,{onClose:a,title:t,confirmationAction:R,confirmationText:s.formatMessage(S.save)},void 0,e(J,{},void 0,e(c,{label:e(f,{id:"edit_federation.reject",defaultMessage:"Reject all activities"})},void 0,e(m,{checked:n,onChange:_("reject"),id:"reject"})),e(c,{label:e(f,{id:"edit_federation.media_removal",defaultMessage:"Strip media"})},void 0,e(m,{checked:D,onChange:C,id:"media_removal",disabled:n})),e(c,{label:e(f,{id:"edit_federation.force_nsfw",defaultMessage:"Force attachments to be marked sensitive"})},void 0,e(m,{checked:x,onChange:_("media_nsfw"),id:"media_nsfw",disabled:n||b})),e(c,{label:e(f,{id:"edit_federation.followers_only",defaultMessage:"Hide posts except to followers"})},void 0,e(m,{checked:M,onChange:_("followers_only"),id:"followers_only",disabled:n})),e(c,{label:e(f,{id:"edit_federation.unlisted",defaultMessage:"Force posts unlisted"})},void 0,e(m,{checked:j,onChange:_("federated_timeline_removal"),id:"federated_timeline_removal",disabled:n||M}))))};export{Q as default};
