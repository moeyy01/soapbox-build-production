import{v as Re}from"./arrows-minimize-7c27a12c.js";import{v as Te}from"./volume-08f8a8f1.js";import{u as De,r as o,cn as H,Z as Fe,R as F,a1 as w,_ as r,df as Ne,I as U,dr as Se,ds as Ce,n as qe}from"../index-961d4ed1.js";import{a as ze,m as Ve,i as Ie,c as He}from"./media-aspect-ratio-df6a7bb1.js";const Ue="/packs/assets/arrows-maximize-91f2dae6.svg",$e="/packs/assets/player-pause-3dad6718.svg",re=()=>!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement),ae=()=>{document.exitFullscreen?document.exitFullscreen():"webkitExitFullscreen"in document?document.webkitExitFullscreen():"mozCancelFullScreen"in document&&document.mozCancelFullScreen()},Be=s=>{s.requestFullscreen?s.requestFullscreen():"webkitRequestFullscreen"in s?s.webkitRequestFullscreen():"mozRequestFullScreen"in s&&s.mozRequestFullScreen()},ue=300,c=qe({play:{id:"video.play",defaultMessage:"Play"},pause:{id:"video.pause",defaultMessage:"Pause"},mute:{id:"video.mute",defaultMessage:"Mute sound"},unmute:{id:"video.unmute",defaultMessage:"Unmute sound"},hide:{id:"video.hide",defaultMessage:"Hide video"},expand:{id:"video.expand",defaultMessage:"Expand video"},close:{id:"video.close",defaultMessage:"Close video"},fullscreen:{id:"video.fullscreen",defaultMessage:"Full screen"},exit_fullscreen:{id:"video.exit_fullscreen",defaultMessage:"Exit full screen"}}),$=s=>{let n=Math.floor(s/3600),u=Math.floor((s-n*3600)/60),l=s-n*3600-u*60;return n<10&&(n="0"+n),u<10&&(u="0"+u),l<10&&(l="0"+l),(n==="00"?"":`${n}:`)+`${u}:${l}`},le=s=>{let n;if(s.getBoundingClientRect&&s.parentNode&&(n=s.getBoundingClientRect()),!n)return{left:0,top:0};const u=document.documentElement,l=document.body,E=u.clientLeft||l.clientLeft||0,v=window.pageXOffset||l.scrollLeft,g=n.left+v-E,_=u.clientTop||l.clientTop||0,d=window.pageYOffset||l.scrollTop,x=n.top+d-_;return{left:Math.round(g),top:Math.round(x)}},B=(s,n)=>{const u=le(s),l=s.offsetWidth,E=s.offsetHeight,v=u.top,g=u.left;let _=n.pageY,d=n.pageX;return n.changedTouches&&(d=n.changedTouches[0].pageX,_=n.changedTouches[0].pageY),{y:Math.max(0,Math.min(1,(_-v)/E)),x:Math.max(0,Math.min(1,(d-g)/l))}},We=s=>{const u=new URL(s).pathname,l=u.lastIndexOf("/");return u.substring(l+1)},Ke=s=>{let{width:n,visible:u=!1,detailed:l=!1,autoFocus:E=!1,cacheWidth:v,startTime:g,src:_,height:d,alt:x,inline:W,aspectRatio:N=16/9,link:K,blurhash:ie}=s;const y=De(),h=o.useRef(null),t=o.useRef(null),S=o.useRef(null),C=o.useRef(null),[O,q]=o.useState(0),[X,ce]=o.useState(0),[Y,z]=o.useState(.5),[m,k]=o.useState(!0),[de,j]=o.useState(!1),[b,me]=o.useState(n),[f,fe]=o.useState(!1),[A,G]=o.useState(!1),[V,I]=o.useState(!1),[pe,ve]=o.useState(0),Z=()=>{if(h.current){const{offsetWidth:e}=h.current;v&&v(e),me(e)}};o.useLayoutEffect(()=>{Z()},[h.current]),o.useEffect(()=>{t.current&&(z(t.current.volume),I(t.current.muted))},[t.current]);const he=e=>e.stopPropagation(),ge=()=>{k(!1)},_e=()=>{k(!0)},ye=()=>{t.current&&(q(Math.floor(t.current.currentTime)),ce(Math.floor(t.current.duration)))},be=e=>{document.addEventListener("mousemove",M,!0),document.addEventListener("mouseup",P,!0),document.addEventListener("touchmove",M,!0),document.addEventListener("touchend",P,!0),M(e),e.preventDefault(),e.stopPropagation()},P=()=>{document.removeEventListener("mousemove",M,!0),document.removeEventListener("mouseup",P,!0),document.removeEventListener("touchmove",M,!0),document.removeEventListener("touchend",P,!0)},M=H(e=>{if(C.current){const{x:a}=B(C.current,e);if(!isNaN(a)){let i=a;a>1?i=1:a<0&&(i=0),t.current&&(t.current.volume=i),z(i)}}},60),Ee=e=>{var a;document.addEventListener("mousemove",L,!0),document.addEventListener("mouseup",R,!0),document.addEventListener("touchmove",L,!0),document.addEventListener("touchend",R,!0),j(!0),(a=t.current)==null||a.pause(),L(e),e.preventDefault(),e.stopPropagation()},R=()=>{var e;document.removeEventListener("mousemove",L,!0),document.removeEventListener("mouseup",R,!0),document.removeEventListener("touchmove",L,!0),document.removeEventListener("touchend",R,!0),j(!1),(e=t.current)==null||e.play()},L=H(e=>{if(S.current&&t.current){const{x:a}=B(S.current,e),i=Math.floor(t.current.duration*a);isNaN(i)||(t.current.currentTime=i,q(i))}},60),T=e=>{if(t.current){const a=t.current.currentTime+e;isNaN(a)||(q(a),t.current.currentTime=a)}},J=e=>{e.key===" "&&(e.preventDefault(),e.stopPropagation(),D())},Me=e=>{switch(e.key){case"k":e.preventDefault(),e.stopPropagation(),D();break;case"m":e.preventDefault(),e.stopPropagation(),ne();break;case"f":e.preventDefault(),e.stopPropagation(),Q();break;case"j":e.preventDefault(),e.stopPropagation(),T(-10);break;case"l":e.preventDefault(),e.stopPropagation(),T(10);break;case",":e.preventDefault(),e.stopPropagation(),T(-.04);break;case".":e.preventDefault(),e.stopPropagation(),T(.04);break}f&&(e.preventDefault(),e.stopPropagation(),e.key==="Escape"&&ae())},D=e=>{var a,i;e==null||e.stopPropagation(),k(!m),m?(a=t.current)==null||a.play():(i=t.current)==null||i.pause()},Q=()=>{re()?ae():h.current&&Be(h.current)},ee=o.useCallback(Fe(()=>{Z()},250,{trailing:!0}),[h.current,v]),te=o.useCallback(H(()=>{if(!t.current)return;const{top:e,height:a}=t.current.getBoundingClientRect(),i=e<=(window.innerHeight||document.documentElement.clientHeight)&&e+a>=0;!m&&!i&&(k(!0),t.current.pause())},150,{trailing:!0}),[t.current,m]),p=o.useCallback(()=>{fe(re())},[]),Le=()=>{G(!0)},we=()=>{G(!1)},ne=()=>{if(t.current){const e=!t.current.muted;I(!e),t.current.muted=e}},xe=()=>{t.current&&g&&(t.current.currentTime=g,t.current.play())},ke=()=>{t.current&&t.current.buffered.length>0&&ve(t.current.buffered.end(0)/t.current.duration*100)},Pe=()=>{t.current&&(z(t.current.volume),I(t.current.muted))},se=O/X*100,oe={};if(W&&b){n=b;const e=b/(16/9);ze(N)?d=Math.max(Math.floor(b/Ve),e):Ie(N)?d=Math.max(Math.floor(b/He),e):d=Math.floor(b/N),oe.height=d||ue}return o.useEffect(()=>(document.addEventListener("fullscreenchange",p,!0),document.addEventListener("webkitfullscreenchange",p,!0),document.addEventListener("mozfullscreenchange",p,!0),document.addEventListener("MSFullscreenChange",p,!0),window.addEventListener("scroll",te),window.addEventListener("resize",ee,{passive:!0}),()=>{window.removeEventListener("scroll",te),window.removeEventListener("resize",ee),document.removeEventListener("fullscreenchange",p,!0),document.removeEventListener("webkitfullscreenchange",p,!0),document.removeEventListener("mozfullscreenchange",p,!0),document.removeEventListener("MSFullscreenChange",p,!0)}),[]),o.useEffect(()=>{var e;u||(e=t.current)==null||e.pause()},[u]),F.createElement("div",{role:"menuitem",className:w("video-player",{detailed:l,"video-player--inline":W&&!f,fullscreen:f}),style:oe,ref:h,onMouseEnter:Le,onMouseLeave:we,onClick:he,onKeyDown:Me,tabIndex:0},!f&&r(Ne,{hash:ie,className:"media-gallery__preview"}),F.createElement("video",{ref:t,src:_,loop:!0,role:"button",tabIndex:0,"aria-label":x,title:x,width:n,height:d||ue,onClick:D,onKeyDown:J,onPlay:ge,onPause:_e,onTimeUpdate:ye,onLoadedData:xe,onProgress:ke,onVolumeChange:Pe}),r("div",{className:w("video-player__controls",{active:m||A})},void 0,F.createElement("div",{className:"video-player__seek",onMouseDown:Ee,ref:S},r("div",{className:"video-player__seek__buffer",style:{width:`${pe}%`}}),r("div",{className:"video-player__seek__progress",style:{width:`${se}%`}}),r("span",{className:w("video-player__seek__handle",{active:de}),tabIndex:0,style:{left:`${se}%`},onKeyDown:J})),r("div",{className:"video-player__buttons-bar"},void 0,r("div",{className:"video-player__buttons left"},void 0,r("button",{type:"button",title:y.formatMessage(m?c.play:c.pause),"aria-label":y.formatMessage(m?c.play:c.pause),className:"player-button",onClick:D,autoFocus:E},void 0,r(U,{src:m?Se:$e})),r("button",{type:"button",title:y.formatMessage(V?c.unmute:c.mute),"aria-label":y.formatMessage(V?c.unmute:c.mute),className:"player-button",onClick:ne},void 0,r(U,{src:V?Ce:Te})),F.createElement("div",{className:w("video-player__volume",{active:A}),onMouseDown:be,ref:C},r("div",{className:"video-player__volume__current",style:{width:`${Y*100}%`}}),r("span",{className:w("video-player__volume__handle"),tabIndex:0,style:{left:`${Y*100}%`}})),(l||f)&&r("span",{},void 0,r("span",{className:"video-player__time-current"},void 0,$(O)),r("span",{className:"video-player__time-sep"},void 0,"/"),r("span",{className:"video-player__time-total"},void 0,$(X))),K&&r("span",{className:"video-player__link"},void 0,K)),r("div",{className:"video-player__buttons right"},void 0,r("button",{type:"button",title:y.formatMessage(f?c.exit_fullscreen:c.fullscreen),"aria-label":y.formatMessage(f?c.exit_fullscreen:c.fullscreen),className:"player-button",onClick:Q},void 0,r(U,{src:f?Re:Ue}))))))},Ae=Object.freeze(Object.defineProperty({__proto__:null,default:Ke,fileNameFromURL:We,findElementPosition:le,formatTime:$,getPointerPosition:B},Symbol.toStringTag,{value:"Module"}));export{Ke as V,Ue as a,$ as f,B as g,Ae as i,$e as v};
