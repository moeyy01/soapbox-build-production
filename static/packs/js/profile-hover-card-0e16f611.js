import{c as H,q as B,u as I,r as d,p as c,b4 as S,a4 as A,hU as D,hV as g,R as L,ay as N,a1 as k,_ as e,a$ as q,a8 as z,g$ as F,hW as T,cC as $,ci as j,H as G,c7 as J,gT as K,G as f,gU as O,K as n,gR as l,b0 as U,hX as V}from"../index-961d4ed1.js";import{u as W}from"./usePopper-596e1bae.js";import{u as X}from"./usePatronUser-1d9992e7.js";const Q=(a,r)=>{const s=[];return a!=null&&a.admin?s.push(e(l,{slug:"admin",title:e(n,{id:"account_moderation_modal.roles.admin",defaultMessage:"Admin"})},"admin")):a!=null&&a.moderator&&s.push(e(l,{slug:"moderator",title:e(n,{id:"account_moderation_modal.roles.moderator",defaultMessage:"Moderator"})},"moderator")),r!=null&&r.is_patron&&s.push(e(l,{slug:"patron",title:e(n,{id:"account.patron",defaultMessage:"Patron"})},"patron")),s},Y=a=>()=>{a(V())},Z=a=>()=>{a(g(!0))},se=a=>{var p;let{visible:r=!0}=a;const s=H(),h=B(),u=I(),[v,_]=d.useState(null),y=c(o=>o.me),i=c(o=>o.profile_hover_card.accountId||void 0),{account:t}=S(i,{withRelationship:!0}),{patronUser:M}=X(t==null?void 0:t.url),b=c(o=>{var m;return(m=o.profile_hover_card.ref)==null?void 0:m.current}),w=Q(t,M);d.useEffect(()=>{i&&s(A([i]))},[s,i]),d.useEffect(()=>{const o=h.listen(()=>{D.cancel(),s(g())});return()=>{o()}},[]);const{styles:P,attributes:C}=W(b,v);if(!t)return null;const E={__html:t.note_emojified},R=u.formatDate(t.created_at,{month:"long",year:"numeric"}),x=y!==t.id&&((p=t.relationship)==null?void 0:p.followed_by)===!0;return L.createElement("div",N({className:k({"absolute transition-opacity w-[320px] z-[101] top-0 left-0":!0,"opacity-100":r,"opacity-0 pointer-events-none":!r}),ref:_,style:P.popper},C.popper,{onMouseEnter:Y(s),onMouseLeave:Z(s)}),e(U,{variant:"rounded",className:"relative isolate overflow-hidden"},void 0,e(q,{},void 0,e(z,{space:2},void 0,e(F,{fetchComponent:T},void 0,o=>e(o,{accountId:t.id,action:e($,{account:t,small:!0}),badges:w})),j(t)?e(G,{alignItems:"center",space:.5},void 0,e(J,{src:K,className:"h-4 w-4 text-gray-800 dark:text-gray-200"}),e(f,{size:"sm",title:u.formatDate(t.created_at,O)},void 0,e(n,{id:"account.member_since",defaultMessage:"Joined {date}",values:{date:R}}))):null,t.note.length>0&&e(f,{size:"sm",dangerouslySetInnerHTML:E})),x&&e("div",{className:"absolute left-2 top-2"},void 0,e(l,{slug:"opaque",title:e(n,{id:"account.follows_you",defaultMessage:"Follows you"})})))))};export{se as ProfileHoverCard,se as default};
