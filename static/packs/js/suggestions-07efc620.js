import{bk as y,c as M,fO as m,f as A,er as D,il as I,eR as x,im as _,a4 as L}from"../index-961d4ed1.js";const f={suggestions:["suggestions"]},b=s=>({id:s.account_id,avatar:s.account_avatar,avatar_static:s.account_avatar,acct:s.acct,display_name:s.display_name,note:s.note,verified:s.verified}),F=()=>{var u;const s=y(),a=M(),p=A(),d=async t=>{var r;const c=(t==null?void 0:t.link)||"/api/v2/suggestions",e=await s.get(c),g=!!e.headers.link,l=(r=x(e).refs.find(i=>i.rel==="next"))==null?void 0:r.uri,o=e.data.map(({account:i})=>i),v=o.map(i=>i.id);return a(_(o)),a(L(v)),{result:e.data.map(i=>({...i,account:i.account.id})),link:l,hasMore:g}},S=async t=>{var v;const c=(t==null?void 0:t.link)||"/api/v1/truth/carousels/suggestions",e=await s.get(c),g=!!e.headers.link,l=(v=x(e).refs.find(r=>r.rel==="next"))==null?void 0:v.uri,o=e.data.map(b);return a(_(o,{should_refetch:!0})),{result:e.data.map(r=>({...r,account:r.account_id})),link:l,hasMore:g}},h=t=>p.truthSuggestions?S(t):d(t),n=m(f.suggestions,({pageParam:t})=>h(t),{keepPreviousData:!0,getNextPageParam:t=>{if(t!=null&&t.hasMore)return{nextLink:t==null?void 0:t.link}}}),k=(u=n.data)==null?void 0:u.pages.reduce((t,c)=>[...t,...c.result],[]);return{...n,data:k||[]}},N=()=>{const s=y();return D(a=>s.delete(`/api/v1/suggestions/${a}`),{onMutate(a){I(f.suggestions,a,(p,d)=>p.account===d)}})};function O(){var h;const s=y(),a=M(),p=async n=>{var l;const k=(n==null?void 0:n.link)||"/api/v2/suggestions",u=await s.get(k),t=!!u.headers.link,c=(l=x(u).refs.find(o=>o.rel==="next"))==null?void 0:l.uri,e=u.data.map(({account:o})=>o),g=e.map(o=>o.id);return a(_(e)),a(L(g)),{data:u.data,link:c,hasMore:t}},d=m(["suggestions","v2"],({pageParam:n})=>p(n),{keepPreviousData:!0,getNextPageParam:n=>{if(n.hasMore)return{link:n.link}}}),S=(h=d.data)==null?void 0:h.pages.reduce((n,k)=>[...n,...k.data],[]);return{...d,data:S}}export{N as a,O as b,F as u};
