import{G as I,a as b,v as L}from"./layout-list-0e6136f9.js";import{bk as S,f as _,bl as w,bm as T,bn as y,jE as C,r as p,_ as t,a1 as d,R as f,ay as x,H as E,c7 as G,a2 as N}from"../index-961d4ed1.js";import{V as k,a as D}from"./index-c72bc579.js";import{u as P}from"./useGroupTag-ff7793d1.js";import{G as V}from"./group-list-item-80a96dc7.js";import"./group-header-image-9d6945b3.js";function q(e){const r=S(),n=_(),{entities:a,...u}=w([y.GROUPS,"tags",e],()=>r.get(`/api/v1/tags/${e}/groups`),{schema:T,enabled:n.groupsDiscovery}),{relationships:m}=C(["tags",e],a.map(i=>i.id)),l=a.map(i=>({...i,relationship:m[i.id]||null}));return{...u,groups:l}}var o=function(e){return e.LIST="LIST",e.GRID="GRID",e}(o||{});const A=f.forwardRef((e,r)=>{const{context:n,...a}=e;return f.createElement("div",x({ref:r},a,{className:"flex flex-wrap"}))}),M=e=>{const r=e.params.id,[n,a]=p.useState(o.LIST),{tag:u,isLoading:m}=P(r),{groups:l,hasNextPage:i,fetchNextPage:R}=q(r),g=()=>{i&&R()},h=p.useCallback((s,c)=>t("div",{className:d({"pt-4":c!==0})},void 0,t(V,{group:s,withJoinAction:!0})),[]),v=p.useCallback(s=>t(I,{group:s}),[]);return m||!u?null:t(N,{label:`#${u.name}`,action:t(E,{alignItems:"center"},void 0,t("button",{onClick:()=>a(o.LIST)},void 0,t(G,{src:b,className:d("h-5 w-5 text-gray-600",{"text-primary-600":n===o.LIST})})),t("button",{onClick:()=>a(o.GRID)},void 0,t(G,{src:L,className:d("h-5 w-5 text-gray-600",{"text-primary-600":n===o.GRID})})))},void 0,n===o.LIST?t(k,{useWindowScroll:!0,data:l,itemContent:(s,c)=>h(c,s),endReached:g}):t(D,{useWindowScroll:!0,data:l,itemContent:(s,c)=>v(c),components:{Item:s=>f.createElement("div",x({},s,{className:"w-1/2 flex-none pb-4 [&:nth-last-of-type(-n+2)]:pb-0"})),List:A},endReached:g}))};export{M as default};
