import{u as v,c as m,r as y,dA as R,dB as w,R as E,bv as I,a1 as D,_ as e,dC as T,dD as F,p as x,G as A,K as s,H as O,am as k,dE as G,C as S,aJ as q,bw as N,dF as P,dG as z,n as H}from"../index-961d4ed1.js";import{c as V}from"./modal-root-13757a66.js";const u=H({close:{id:"lightbox.close",defaultMessage:"Close"},confirm:{id:"confirmations.cancel.confirm",defaultMessage:"Discard"},cancelEditing:{id:"confirmations.cancel_editing.confirm",defaultMessage:"Cancel editing"}}),Q=d=>{let{onClose:i,composeId:t="compose-modal"}=d;const l=v(),o=m(),n=y.useRef(null),c=R(t),{id:a,privacy:g,in_reply_to:r,quote:f,group_id:p}=c,{isDragging:_,isDraggedOver:C}=w(n,b=>{o(G(t,b,l))}),M=()=>{V(c)?o(S("CONFIRM",{icon:q,heading:a?e(s,{id:"confirmations.cancel_editing.heading",defaultMessage:"Cancel post editing"}):e(s,{id:"confirmations.cancel.heading",defaultMessage:"Discard post"}),message:a?e(s,{id:"confirmations.cancel_editing.message",defaultMessage:"Are you sure you want to cancel editing this post? All changes will be lost."}):e(s,{id:"confirmations.cancel.message",defaultMessage:"Are you sure you want to cancel creating this post?"}),confirm:l.formatMessage(a?u.cancelEditing:u.confirm),onConfirm:()=>{o(N("COMPOSE")),o(P())}})):i("COMPOSE")},h=()=>a?e(s,{id:"navigation_bar.compose_edit",defaultMessage:"Edit post"}):g==="direct"?e(s,{id:"navigation_bar.compose_direct",defaultMessage:"Direct message"}):r&&p?e(s,{id:"navigation_bar.compose_group_reply",defaultMessage:"Reply to group post"}):p?e(s,{id:"navigation_bar.compose_group",defaultMessage:"Compose to group"}):r?e(s,{id:"navigation_bar.compose_reply",defaultMessage:"Reply to post"}):f?e(s,{id:"navigation_bar.compose_quote",defaultMessage:"Quote post"}):e(s,{id:"navigation_bar.compose",defaultMessage:"Compose new post"});return E.createElement(I,{ref:n,title:h(),onClose:M,className:D({"border-2 border-primary-600 border-dashed !z-[99]":_,"ring-2 ring-offset-2 ring-primary-600":C})},e(T,{id:t,extra:e(B,{composeId:t,groupId:p})}))},B=d=>{let{composeId:i,groupId:t}=d;const l=m(),{group:o}=F(t||"",!1),n=x(g=>{var r;return!!((r=g.compose.get(i))!=null&&r.group_timeline_visible)}),c=()=>{l(z(i,!n))},a=`group-timeline-visible+${i}`;return!o||o.locked?null:e(O,{alignItems:"center",space:4},void 0,e("label",{className:"ml-auto cursor-pointer",htmlFor:a},void 0,e(A,{theme:"muted"},void 0,e(s,{id:"compose_group.share_to_followers",defaultMessage:"Share with my followers"}))),e(k,{id:a,checked:n,onChange:c,size:"sm"}))};export{Q as default};
