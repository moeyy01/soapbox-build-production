import{p as c,_ as e,a8 as S,G as E,c7 as Z,H as T,gV as Q,u as L,c as O,r as C,ba as j,cn as de,iX as me,I as F,aA as ue,a1 as H,iY as pe,n as ee,R as z,K as s,iZ as ge,bG as y,b_ as ve,bH as he,aI as U,ab as V,bF as fe,g$ as $,ii as G,am as K,aE as _e,bv as Me,af as J,M as be,i_ as Ce,i$ as Ee,j0 as ye,j1 as Te,j2 as ke,j3 as Se,j4 as xe,C as Ie,aJ as Re,bw as qe,dI as we,j5 as Ne,j6 as Pe,j7 as je,T as Ae,j8 as De,j9 as Fe}from"../index-961d4ed1.js";import{v as ze}from"./backspace-c284aa0a.js";import{a as Le}from"./modal-root-13757a66.js";import{isCurrentOrFutureDate as W}from"./schedule-form-affaf920.js";import{v as Oe}from"./photo-plus-d58838d9.js";const Be="/packs/assets/road-3636cb68.svg",He="/packs/assets/home-2-1de3a8c6.svg",Ue="/packs/assets/building-community-2a262560.svg",A=Ue,Ve=He,$e=Q,X=Be,te={house:Ve,street:X,secondary:X,zone:A,city:A,administrative:A},Ge=h=>{let{id:m}=h;const a=c(n=>n.locations.get(m));return a?e(T,{alignItems:"center",space:2},void 0,e(Z,{src:te[a.type]||$e}),e(S,{},void 0,e(E,{},void 0,a.description),e(E,{size:"xs",theme:"muted"},void 0,[a.street,a.locality,a.country].filter(n=>n==null?void 0:n.trim()).join(" · ")))):null},D=()=>{},Y=ee({placeholder:{id:"location_search.placeholder",defaultMessage:"Find an address"}}),Ke=h=>{let{onSelected:m}=h;const a=L(),n=O(),[l,u]=C.useState(j()),f=C.useRef(new AbortController),[d,i]=C.useState(""),b=()=>!(d.length>0),x=p=>{let{target:g}=p;r(),q(g.value),i(g.value)},k=(p,g,M)=>{typeof M=="string"&&m(M)},I=p=>{p.preventDefault(),b()||i("")},_=p=>{var g,M;p.key==="Escape"&&((M=(g=document.querySelector(".ui"))==null?void 0:g.parentElement)==null||M.focus())},r=()=>{f.current.abort(),f.current=new AbortController},R=()=>{u(j())},q=C.useCallback(de(p=>{n(me(p,f.current.signal)).then(g=>{const M=g.map(w=>w.origin_id);u(j(M))}).catch(D)},900,{leading:!0,trailing:!0}),[]);return C.useEffect(()=>{d===""&&R()},[d]),e("div",{className:"search"},void 0,e(pe,{className:"rounded-full",placeholder:a.formatMessage(Y.placeholder),value:d,onChange:x,suggestions:l.toList(),onSuggestionsFetchRequested:D,onSuggestionsClearRequested:D,onSuggestionSelected:k,searchTokens:[],onKeyDown:_,renderSuggestion:Ge}),e("div",{role:"button",tabIndex:0,className:"search__icon",onClick:I},void 0,e(F,{src:ue,className:H("svg-icon--search",{active:b()})}),e(F,{src:ze,className:H("svg-icon--backspace",{active:!b()}),"aria-label":a.formatMessage(Y.placeholder)})))},Je=h=>{var d;let{disabled:m,onSelectFile:a}=h;const n=C.useRef(null),l=(d=c(i=>i.instance.configuration.getIn(["media_attachments","supported_mime_types"])))==null?void 0:d.filter(i=>i.startsWith("image/")),u=i=>{var b;(b=i.target.files)!=null&&b.length&&a(i.target.files)};return e(T,{className:"h-full w-full cursor-pointer text-primary-500 dark:text-accent-blue",space:3,alignItems:"center",justifyContent:"center",element:"label"},void 0,e(F,{src:Oe,className:"h-7 w-7",onClick:()=>{var i;(i=n.current)==null||i.click()}}),e(E,{size:"sm",theme:"primary",weight:"semibold",transform:"uppercase",tabIndex:0},void 0,e(s,{id:"compose_event.upload_banner",defaultMessage:"Upload photo"})),z.createElement("input",{ref:n,type:"file",accept:l&&l.toArray().join(","),onChange:u,disabled:m,className:"hidden"}))},v=ee({eventNamePlaceholder:{id:"compose_event.fields.name_placeholder",defaultMessage:"Name"},eventDescriptionPlaceholder:{id:"compose_event.fields.description_placeholder",defaultMessage:"Description"},eventStartTimePlaceholder:{id:"compose_event.fields.start_time_placeholder",defaultMessage:"Event begins on…"},eventEndTimePlaceholder:{id:"compose_event.fields.end_time_placeholder",defaultMessage:"Event ends on…"},resetLocation:{id:"compose_event.reset_location",defaultMessage:"Reset location"},edit:{id:"compose_event.tabs.edit",defaultMessage:"Edit details"},pending:{id:"compose_event.tabs.pending",defaultMessage:"Manage requests"},authorize:{id:"compose_event.participation_requests.authorize",defaultMessage:"Authorize"},reject:{id:"compose_event.participation_requests.reject",defaultMessage:"Reject"},confirm:{id:"confirmations.delete.confirm",defaultMessage:"Delete"},cancelEditing:{id:"confirmations.cancel_editing.confirm",defaultMessage:"Cancel editing"}}),We=h=>{let{eventId:m,id:a,participationMessage:n}=h;const l=L(),u=O(),f=()=>{u(De(m,a))},d=()=>{u(Fe(m,a))};return e(be,{id:a,note:n||void 0,action:e(T,{space:2},void 0,e(J,{theme:"secondary",size:"sm",text:l.formatMessage(v.authorize),onClick:f}),e(J,{theme:"danger",size:"sm",text:l.formatMessage(v.reject),onClick:d}))})},tt=h=>{let{onClose:m}=h;const a=L(),n=O(),[l,u]=C.useState("edit"),f=c(t=>t.compose_event.banner),d=c(t=>t.compose_event.is_uploading),i=c(t=>t.compose_event.name),b=c(t=>t.compose_event.status),x=c(t=>t.compose_event.start_time),k=c(t=>t.compose_event.end_time),I=c(t=>t.compose_event.approval_required),_=c(t=>t.compose_event.location),r=c(t=>t.compose_event.id),R=c(t=>t.compose_event.is_submitting),q=t=>{let{target:o}=t;n(Ce(o.value))},p=t=>{let{target:o}=t;n(Ee(o.value))},g=t=>{n(ye(t))},M=t=>{n(Te(t))},w=t=>{let{target:o}=t;n(ke(o.checked))},ae=t=>{let{target:o}=t;n(Se(o.checked))},B=t=>{n(xe(t))},ne=()=>{n((t,o)=>{Le(o().compose_event)?t(Ie("CONFIRM",{icon:Re,heading:r?e(s,{id:"confirmations.cancel_event_editing.heading",defaultMessage:"Cancel event editing"}):e(s,{id:"confirmations.delete_event.heading",defaultMessage:"Delete event"}),message:r?e(s,{id:"confirmations.cancel_event_editing.message",defaultMessage:"Are you sure you want to cancel editing this event? All changes will be lost."}):e(s,{id:"confirmations.delete_event.message",defaultMessage:"Are you sure you want to delete this event?"}),confirm:a.formatMessage(v.confirm),onConfirm:()=>{t(qe("COMPOSE_EVENT")),t(we())}})):m("COMPOSE_EVENT")})},se=t=>{n(Ne(t[0],a))},oe=()=>{n(Pe())},ie=()=>{n(je())},N=c(t=>{var o;return(o=t.user_lists.event_participation_requests.get(r))==null?void 0:o.items});C.useEffect(()=>{r&&n(ge(r))},[]);const ce=()=>_&&e(T,{className:"h-[38px] text-gray-700 dark:text-gray-500",alignItems:"center",space:2},void 0,e(Z,{src:te[_.type]||Q}),e(S,{className:"grow"},void 0,e(E,{},void 0,_.description),e(E,{theme:"muted",size:"xs"},void 0,[_.street,_.locality,_.country].filter(t=>t==null?void 0:t.trim()).join(" · "))),e(U,{title:a.formatMessage(v.resetLocation),src:V,onClick:()=>B(null)})),re=()=>{const t=[{text:a.formatMessage(v.edit),action:()=>u("edit"),name:"edit"},{text:a.formatMessage(v.pending),action:()=>u("pending"),name:"pending"}];return e(Ae,{items:t,activeItem:l})};let P;return l==="edit"?P=e(fe,{},void 0,e(y,{labelText:e(s,{id:"compose_event.fields.banner_label",defaultMessage:"Event banner"})},void 0,e("div",{className:"dark:sm:shadow-inset relative flex h-24 items-center justify-center overflow-hidden rounded-lg bg-primary-100 text-primary-500 dark:bg-gray-800 dark:text-white sm:h-32 sm:shadow"},void 0,f?z.createElement(z.Fragment,null,e("img",{className:"h-full w-full object-cover",src:f.url,alt:""}),e(U,{className:"absolute right-2 top-2",src:V,onClick:oe})):e(Je,{disabled:d,onSelectFile:se}))),e(y,{labelText:e(s,{id:"compose_event.fields.name_label",defaultMessage:"Event name"})},void 0,e(he,{type:"text",placeholder:a.formatMessage(v.eventNamePlaceholder),value:i,onChange:q})),e(y,{labelText:e(s,{id:"compose_event.fields.description_label",defaultMessage:"Event description"}),hintText:e(s,{id:"compose_event.fields.description_hint",defaultMessage:"Markdown syntax is supported"})},void 0,e(ve,{autoComplete:"off",placeholder:a.formatMessage(v.eventDescriptionPlaceholder),value:b,onChange:p})),e(y,{labelText:e(s,{id:"compose_event.fields.location_label",defaultMessage:"Event location"})},void 0,_?ce():e(Ke,{onSelected:B})),e(y,{labelText:e(s,{id:"compose_event.fields.start_time_label",defaultMessage:"Event start date"})},void 0,e($,{fetchComponent:G},void 0,t=>e(t,{showTimeSelect:!0,dateFormat:"MMMM d, yyyy h:mm aa",timeIntervals:15,wrapperClassName:"react-datepicker-wrapper",placeholderText:a.formatMessage(v.eventStartTimePlaceholder),filterDate:W,selected:x,onChange:g}))),e(T,{alignItems:"center",space:2},void 0,e(K,{checked:!!k,onChange:w}),e(E,{tag:"span",theme:"muted"},void 0,e(s,{id:"compose_event.fields.has_end_time",defaultMessage:"The event has end date"}))),k&&e(y,{labelText:e(s,{id:"compose_event.fields.end_time_label",defaultMessage:"Event end date"})},void 0,e($,{fetchComponent:G},void 0,t=>e(t,{showTimeSelect:!0,dateFormat:"MMMM d, yyyy h:mm aa",timeIntervals:15,wrapperClassName:"react-datepicker-wrapper",placeholderText:a.formatMessage(v.eventEndTimePlaceholder),filterDate:W,selected:k,onChange:M}))),!r&&e(T,{alignItems:"center",space:2},void 0,e(K,{checked:I,onChange:ae}),e(E,{tag:"span",theme:"muted"},void 0,e(s,{id:"compose_event.fields.approval_required",defaultMessage:"I want to approve participation requests manually"})))):P=N?e(S,{space:3},void 0,N.size>0?N.map(t=>{let{account:o,participation_message:le}=t;return e(We,{eventId:r,id:o,participationMessage:le},o)}):e(s,{id:"empty_column.event_participant_requests",defaultMessage:"There are no pending event participation requests."})):e(_e,{}),e(Me,{title:r?e(s,{id:"navigation_bar.compose_event",defaultMessage:"Manage event"}):e(s,{id:"navigation_bar.create_event",defaultMessage:"Create new event"}),confirmationAction:l==="edit"?ie:void 0,confirmationText:r?e(s,{id:"compose_event.update",defaultMessage:"Update"}):e(s,{id:"compose_event.create",defaultMessage:"Create"}),confirmationDisabled:R,onClose:ne},void 0,e(S,{space:2},void 0,r&&re(),P))};export{tt as default};
