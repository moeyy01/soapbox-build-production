import{eQ as i,bq as d,n as l,eR as E,eS as g,c as O,u as S,r as b,_ as c,bJ as T,af as M,G as m,bF as h,a2 as C}from"../index-961d4ed1.js";const L="EXPORT_FOLLOWS_REQUEST",R="EXPORT_FOLLOWS_SUCCESS",y="EXPORT_FOLLOWS_FAIL",w="EXPORT_BLOCKS_REQUEST",U="EXPORT_BLOCKS_SUCCESS",k="EXPORT_BLOCKS_FAIL",F="EXPORT_MUTES_REQUEST",P="EXPORT_MUTES_SUCCESS",X="EXPORT_MUTES_FAIL",_=l({blocksSuccess:{id:"export_data.success.blocks",defaultMessage:"Blocks exported successfully"},followersSuccess:{id:"export_data.success.followers",defaultMessage:"Followers exported successfully"},mutesSuccess:{id:"export_data.success.mutes",defaultMessage:"Mutes exported successfully"}});function p(s,e){const t=document.createElement("a");t.setAttribute("href","data:text/csv;charset=utf-8,"+encodeURIComponent(s)),t.setAttribute("download",e),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}const f=s=>async e=>{const t=e.data;let o=[],a=E(e).refs.find(n=>n.rel==="next");for(;a;)e=await i(s).get(a.uri),a=E(e).refs.find(n=>n.rel==="next"),Array.prototype.push.apply(t,e.data);return o=t.map(n=>g(n).fqn),Array.from(new Set(o))},v=()=>(s,e)=>{s({type:L});const t=e().me;return i(e).get(`/api/v1/accounts/${t}/following?limit=40`).then(f(e)).then(o=>{o=o.map(a=>a+",true"),o.unshift("Account address,Show boosts"),p(o.join(`
`),"export_followings.csv"),d.success(_.followersSuccess),s({type:R})}).catch(o=>{s({type:y,error:o})})},A=()=>(s,e)=>(s({type:w}),i(e).get("/api/v1/blocks?limit=40").then(f(e)).then(t=>{p(t.join(`
`),"export_block.csv"),d.success(_.blocksSuccess),s({type:U})}).catch(t=>{s({type:k,error:t})})),B=()=>(s,e)=>(s({type:F}),i(e).get("/api/v1/mutes?limit=40").then(f(e)).then(t=>{p(t.join(`
`),"export_mutes.csv"),d.success(_.mutesSuccess),s({type:P})}).catch(t=>{s({type:X,error:t})})),r=s=>{let{messages:e,action:t}=s;const o=O(),a=S(),[n,u]=b.useState(!1),x=G=>{u(!0),o(t()).then(()=>{u(!1)}).catch(()=>{u(!1)})};return c(h,{},void 0,c(m,{size:"xl",weight:"bold"},void 0,a.formatMessage(e.input_label)),c(m,{theme:"muted"},void 0,a.formatMessage(e.input_hint)),c(T,{},void 0,c(M,{theme:"primary",onClick:x,disabled:n},void 0,a.formatMessage(e.submit))))},I=l({heading:{id:"column.export_data",defaultMessage:"Export data"},submit:{id:"export_data.actions.export",defaultMessage:"Export"}}),Q=l({input_label:{id:"export_data.follows_label",defaultMessage:"Follows"},input_hint:{id:"export_data.hints.follows",defaultMessage:"Get a CSV file containing a list of followed accounts"},submit:{id:"export_data.actions.export_follows",defaultMessage:"Export follows"}}),K=l({input_label:{id:"export_data.blocks_label",defaultMessage:"Blocks"},input_hint:{id:"export_data.hints.blocks",defaultMessage:"Get a CSV file containing a list of blocked accounts"},submit:{id:"export_data.actions.export_blocks",defaultMessage:"Export blocks"}}),W=l({input_label:{id:"export_data.mutes_label",defaultMessage:"Mutes"},input_hint:{id:"export_data.hints.mutes",defaultMessage:"Get a CSV file containing a list of muted accounts"},submit:{id:"export_data.actions.export_mutes",defaultMessage:"Export mutes"}}),j=()=>{const s=S();return c(C,{label:s.formatMessage(I.heading)},void 0,c(r,{action:v,messages:Q}),c(r,{action:A,messages:K}),c(r,{action:B,messages:W}))};export{j as default};
