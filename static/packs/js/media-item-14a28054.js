import{d as M,r as w,_ as a,de as E,R as P,ay as R,a1 as f,df as k,dg as L,I as p,dh as O}from"../index-961d4ed1.js";import{v as S}from"./volume-08f8a8f1.js";const q=v=>{var _;let{attachment:e,onOpenMedia:g}=v;const r=M(),o=r.get("autoPlayGif"),c=r.get("displayMedia"),[i,y]=w.useState(c!=="hide_all"&&!((_=e.status)!=null&&_.sensitive)||c==="show_all"),h=t=>{const s=t.target;d()&&s.play()},b=t=>{const s=t.target;d()&&(s.pause(),s.currentTime=0)},d=()=>!o&&["gifv","video"].includes(e.type),x=t=>{t.button===0&&!(t.ctrlKey||t.metaKey)&&(t.preventDefault(),i?g(e):y(!0))},u=e.status,N=u.spoiler_text||e.description;let l="",m;if(e.type!=="unknown"){if(e.type==="image"){const t=Number(e.meta.getIn(["focus","x"]))||0,s=Number(e.meta.getIn(["focus","y"]))||0,n=(t/2+.5)*100,I=(s/-2+.5)*100;l=a(E,{src:e.preview_url,alt:e.description,style:{objectPosition:`${n}% ${I}%`},className:"h-full w-full overflow-hidden rounded-lg"})}else if(["gifv","video"].indexOf(e.type)!==-1){const t={};L()&&(t.playsInline=!0),o&&(t.autoPlay=!0),l=a("div",{className:f("media-gallery__gifv",{autoplay:o})},void 0,P.createElement("video",R({className:"media-gallery__item-gifv-thumbnail","aria-label":e.description,title:e.description,role:"application",src:e.url,onMouseEnter:h,onMouseLeave:b,loop:!0,muted:!0},t)),a("span",{className:"media-gallery__gifv__label"},void 0,"GIF"))}else if(e.type==="audio"){const t=e.remote_url||"",s=t.lastIndexOf("."),n=t.slice(s+1).toUpperCase();l=a("div",{className:"media-gallery__item-thumbnail"},void 0,a("span",{className:"media-gallery__item__icons"},void 0,a(p,{src:S})),a("span",{className:"media-gallery__file-extension__label"},void 0,n))}}return i||(m=a("span",{className:"media-gallery__item__icons"},void 0,a(p,{src:O}))),a("div",{className:"col-span-1"},void 0,a("a",{className:"media-gallery__item-thumbnail aspect-1",href:u.url,target:"_blank",onClick:x,title:N},void 0,a(k,{hash:e.blurhash,className:f("media-gallery__preview",{"media-gallery__preview--hidden":i})}),i&&l,!i&&m))};export{q as M};
