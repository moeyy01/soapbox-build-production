import{u as x,c as P,t as C,r as s,_ as e,bF as k,G as I,K as r,N as L,R as v,bG as w,bH as M,bJ as S,af as T,a2 as R,n as q,ih as E,bq as b}from"../index-961d4ed1.js";const t=q({heading:{id:"column.migration",defaultMessage:"Account migration"},submit:{id:"migration.submit",defaultMessage:"Move followers"},moveAccountSuccess:{id:"migration.move_account.success",defaultMessage:"Account successfully moved."},moveAccountFail:{id:"migration.move_account.fail",defaultMessage:"Account migration failed."},moveAccountFailCooldownPeriod:{id:"migration.move_account.fail.cooldown_period",defaultMessage:"You have moved your account too recently. Please try again later."},acctFieldLabel:{id:"migration.fields.acct.label",defaultMessage:"Handle of the new account"},acctFieldPlaceholder:{id:"migration.fields.acct.placeholder",defaultMessage:"username@domain"},currentPasswordFieldLabel:{id:"migration.fields.confirm_password.label",defaultMessage:"Current password"}}),Y=()=>{const a=x(),y=P(),n=C().pleroma.getIn(["metadata","migration_cooldown_period"]),[i,c]=s.useState(""),[l,d]=s.useState(""),[F,u]=s.useState(!1),m=o=>{o.target.name==="password"?d(o.target.value):c(o.target.value)},A=()=>{c(""),d("")},g=o=>(u(!0),y(E(i,l)).then(()=>{A(),b.success(a.formatMessage(t.moveAccountSuccess))}).catch(_=>{var h,p;let f=a.formatMessage(t.moveAccountFail);((p=(h=_.response)==null?void 0:h.data)==null?void 0:p.error)==="You are within cooldown period."&&(f=a.formatMessage(t.moveAccountFailCooldownPeriod)),b.error(f)}).then(()=>{u(!1)}));return e(R,{label:a.formatMessage(t.heading)},void 0,e(k,{onSubmit:g},void 0,e(I,{theme:"muted"},void 0,e(r,{id:"migration.hint",defaultMessage:"This will move your followers to the new account. No other data will be moved. To perform migration, you need to {link} on your new account first.",values:{link:e(L,{className:"text-primary-600 hover:text-primary-800 hover:underline dark:text-primary-400 dark:hover:text-primary-500",to:"/settings/aliases"},void 0,e(r,{id:"migration.hint.link",defaultMessage:"create an account alias"}))}}),!!n&&v.createElement(v.Fragment,null," ",e(r,{id:"migration.hint.cooldown_period",defaultMessage:"If you migrate your account, you will not be able to migrate your account for {cooldownPeriod, plural, one {one day} other {the next # days}}.",values:{cooldownPeriod:n}}))),e(w,{labelText:a.formatMessage(t.acctFieldLabel)},void 0,e(M,{name:"targetAccount",placeholder:a.formatMessage(t.acctFieldPlaceholder),onChange:m,value:i,required:!0})),e(w,{labelText:a.formatMessage(t.currentPasswordFieldLabel)},void 0,e(M,{type:"password",name:"password",onChange:m,value:l,required:!0})),e(S,{},void 0,e(T,{theme:"primary",text:a.formatMessage(t.submit),onClick:g,disabled:F}))))};export{Y as default};
