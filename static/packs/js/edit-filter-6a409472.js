import{u as q,q as X,c as Y,f as Z,r as o,bD as $,bE as ee,_ as e,aF as te,bF as se,bG as V,bH as z,bI as ae,a8 as ie,G as w,K as v,ak as L,al as c,am as d,bJ as oe,af as re,a2 as ne,n as le,H as R,bK as de,bL as ce,bq as ue}from"../index-961d4ed1.js";import{S as fe}from"./streamfield-e3bece9e.js";const a=le({subheading_add_new:{id:"column.filters.subheading_add_new",defaultMessage:"Add New Filter"},title:{id:"column.filters.title",defaultMessage:"Title"},keyword:{id:"column.filters.keyword",defaultMessage:"Keyword or phrase"},keywords:{id:"column.filters.keywords",defaultMessage:"Keywords or phrases"},expires:{id:"column.filters.expires",defaultMessage:"Expire after"},home_timeline:{id:"column.filters.home_timeline",defaultMessage:"Home timeline"},public_timeline:{id:"column.filters.public_timeline",defaultMessage:"Public timeline"},notifications:{id:"column.filters.notifications",defaultMessage:"Notifications"},conversations:{id:"column.filters.conversations",defaultMessage:"Conversations"},accounts:{id:"column.filters.accounts",defaultMessage:"Accounts"},drop_header:{id:"column.filters.drop_header",defaultMessage:"Drop instead of hide"},drop_hint:{id:"column.filters.drop_hint",defaultMessage:"Filtered posts will disappear irreversibly, even if filter is later removed"},hide_header:{id:"column.filters.hide_header",defaultMessage:"Hide completely"},hide_hint:{id:"column.filters.hide_hint",defaultMessage:"Completely hide the filtered content, instead of showing a warning"},add_new:{id:"column.filters.add_new",defaultMessage:"Add New Filter"},edit:{id:"column.filters.edit",defaultMessage:"Edit Filter"},create_error:{id:"column.filters.create_error",defaultMessage:"Error adding filter"},expiration_never:{id:"colum.filters.expiration.never",defaultMessage:"Never"},expiration_1800:{id:"colum.filters.expiration.1800",defaultMessage:"30 minutes"},expiration_3600:{id:"colum.filters.expiration.3600",defaultMessage:"1 hour"},expiration_21600:{id:"colum.filters.expiration.21600",defaultMessage:"6 hours"},expiration_43200:{id:"colum.filters.expiration.43200",defaultMessage:"12 hours"},expiration_86400:{id:"colum.filters.expiration.86400",defaultMessage:"1 day"},expiration_604800:{id:"colum.filters.expiration.604800",defaultMessage:"1 week"}}),me=h=>{let{value:n,onChange:i}=h;const g=q(),u=l=>f=>i({...n,[l]:f.currentTarget[f.currentTarget.type==="checkbox"?"checked":"value"]});return e(R,{space:2,grow:!0},void 0,e(z,{type:"text",outerClassName:"w-2/5 grow",value:n.keyword,onChange:u("keyword"),placeholder:g.formatMessage(a.keyword)}),e(R,{alignItems:"center",space:2},void 0,e(d,{checked:n.whole_word,onChange:u("whole_word")}),e(w,{tag:"span",theme:"muted"},void 0,e(v,{id:"column.filters.whole_word",defaultMessage:"Whole word"}))))},pe=h=>{let{params:n}=h;const i=q(),g=X(),u=Y(),l=Z(),[f,b]=o.useState(!1),[G,J]=o.useState(!1),[p,y]=o.useState(""),[k,P]=o.useState(null),[F,C]=o.useState(!0),[S,I]=o.useState(!1),[T,E]=o.useState(!1),[A,N]=o.useState(!1),[H,K]=o.useState(!1),[_,D]=o.useState(!1),[M,m]=o.useState([{keyword:"",whole_word:!1}]),B=o.useMemo(()=>({"":i.formatMessage(a.expiration_never),1800:i.formatMessage(a.expiration_1800),3600:i.formatMessage(a.expiration_3600),21600:i.formatMessage(a.expiration_21600),43200:i.formatMessage(a.expiration_43200),86400:i.formatMessage(a.expiration_86400),604800:i.formatMessage(a.expiration_604800)}),[]),O=t=>{P(t.target.value)},W=t=>{t.preventDefault();const s=[];F&&s.push("home"),S&&s.push("public"),T&&s.push("notifications"),A&&s.push("thread"),H&&s.push("account"),u(n.id?de(n.id,p,k,s,_,M):ce(p,k,s,_,M)).then(()=>{g.push("/filters")}).catch(()=>{ue.error(i.formatMessage(a.create_error))})},j=t=>m(t),Q=()=>m(t=>[...t,{keyword:"",whole_word:!1}]),U=t=>m(s=>s[t].id?s.map((r,x)=>x===t?{...r,_destroy:!0}:r):s.filter((r,x)=>x!==t));return o.useEffect(()=>{var t;n.id&&(b(!0),(t=u($(n.id)))==null||t.then(s=>{if(s.filter){const r=ee(s.filter);y(r.title),C(r.context.includes("home")),I(r.context.includes("public")),E(r.context.includes("notifications")),N(r.context.includes("thread")),K(r.context.includes("account")),D(r.filter_action==="hide"),m(r.keywords.toJS())}else J(!0);b(!1)}))},[n.id]),G?e(te,{}):e(ne,{className:"filter-settings-panel",label:i.formatMessage(a.subheading_add_new)},void 0,e(se,{onSubmit:W},void 0,e(V,{labelText:i.formatMessage(a.title)},void 0,e(z,{required:!0,type:"text",name:"title",value:p,onChange:t=>{let{target:s}=t;return y(s.value)}})),l.filtersExpiration&&e(V,{labelText:i.formatMessage(a.expires)},void 0,e(ae,{items:B,defaultValue:"",onChange:O})),e(ie,{},void 0,e(w,{size:"sm",weight:"medium"},void 0,e(v,{id:"filters.context_header",defaultMessage:"Filter contexts"})),e(w,{size:"xs",theme:"muted"},void 0,e(v,{id:"filters.context_hint",defaultMessage:"One or multiple contexts where the filter should apply"}))),e(L,{},void 0,e(c,{label:i.formatMessage(a.home_timeline)},void 0,e(d,{checked:F,onChange:t=>{let{target:s}=t;return C(s.checked)}})),e(c,{label:i.formatMessage(a.public_timeline)},void 0,e(d,{checked:S,onChange:t=>{let{target:s}=t;return I(s.checked)}})),e(c,{label:i.formatMessage(a.notifications)},void 0,e(d,{checked:T,onChange:t=>{let{target:s}=t;return E(s.checked)}})),e(c,{label:i.formatMessage(a.conversations)},void 0,e(d,{checked:A,onChange:t=>{let{target:s}=t;return N(s.checked)}})),l.filtersV2&&e(c,{label:i.formatMessage(a.accounts)},void 0,e(d,{checked:H,onChange:t=>{let{target:s}=t;return K(s.checked)}}))),e(L,{},void 0,e(c,{label:i.formatMessage(l.filtersV2?a.hide_header:a.drop_header),hint:i.formatMessage(l.filtersV2?a.hide_hint:a.drop_hint)},void 0,e(d,{checked:_,onChange:t=>{let{target:s}=t;return D(s.checked)}}))),e(fe,{label:i.formatMessage(a.keywords),component:me,values:M,onChange:j,onAddItem:Q,onRemoveItem:U,minItems:1,maxItems:l.filtersV2?1/0:1}),e(oe,{},void 0,e(re,{type:"submit",theme:"primary",disabled:f},void 0,i.formatMessage(n.id?a.edit:a.add_new)))))};export{pe as default};
